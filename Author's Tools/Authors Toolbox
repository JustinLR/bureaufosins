# Import necessary modules
import tkinter as tk
from tkinter import ttk
from tkinter import Menu
import webbrowser
from character_creator_module import setup_character_creator  # Import the Character Creator module function

# Function to show the selected tab's content
def show_tab(tab_frame, content_func):
    # Hide all tab frames
    for frame in (homepage_frame, character_creator_frame, book_hub_frame):
        frame.pack_forget()
    
    # Show the selected tab frame
    tab_frame.pack(fill=tk.BOTH, expand=True)
    
    # Call the function to configure the tab's content
    content_func()

# Define functions to display module contents
def character_creator_content():
    # Clear the character_creator_frame
    for widget in character_creator_frame.winfo_children():
        widget.destroy()

    # Create a canvas for the character_creator_frame
    character_creator_canvas = tk.Canvas(character_creator_frame, height=400)
    character_creator_canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)

    # Create a scrollbar for the character_creator_canvas
    character_creator_scrollbar = ttk.Scrollbar(character_creator_frame, orient="vertical", command=character_creator_canvas.yview)
    character_creator_scrollbar.pack(side=tk.RIGHT, fill="y")

    # Configure the canvas to scroll
    character_creator_canvas.configure(yscrollcommand=character_creator_scrollbar.set)
    character_creator_canvas_frame = tk.Frame(character_creator_canvas)
    character_creator_canvas.create_window((0, 0), window=character_creator_canvas_frame, anchor="nw")

    # Call the setup_character_creator function from the character_creator_module
    character_creator_content = setup_character_creator(character_creator_canvas_frame)

    # Add the content to the canvas_frame
    character_creator_canvas.create_window((0, 0), window=character_creator_content, anchor="nw")

    # Function to configure the canvas scroll region
    def configure_canvas(event):
        character_creator_canvas.configure(scrollregion=character_creator_canvas.bbox("all"))
    
    character_creator_canvas.bind("<Configure>", configure_canvas)

    # Create content for the character_creator_canvas_frame
    content = tk.Label(character_creator_canvas_frame, text="Character Creator")
    content.pack()

    # Call the setup_character_creator function from the character_creator_module
    setup_character_creator(character_creator_canvas_frame)

def book_hub_content():
    # Create content for the book_hub_frame
    content = tk.Label(book_hub_frame, text=" Book Hub")
    content.pack()

def homepage_content():
    # Clear the homepage_frame
    for widget in homepage_frame.winfo_children():
        widget.destroy()
    
    # Create content for the homepage_frame (Placeholder content)
    content = tk.Label(homepage_frame, text="Welcome to the Author's Toolbox!")
    content.pack()

def close_application():
    # Close the application
    root.destroy()

def open_website(event):
    webbrowser.open("http://www.bureauofsins.com")

def about():
    # Create a new window for the About information
    about_window = tk.Toplevel(root)
    about_window.title("About")
    about_label = tk.Label(about_window, text="Author's Toolbox - Version 1.0\nÂ© 2024 J. L. Richards")
    about_label.pack(padx=20, pady=10)
    
    # Add your website address as a clickable hyperlink
    website_label = tk.Label(about_window, text="Website: www.bureauofsins.com", fg="blue", cursor="hand2")
    website_label.pack(padx=20, pady=10)
    website_label.bind("<Button-1>", open_website)

# Create the main application window
root = tk.Tk()
root.title("Author's Toolbox")

# Create a Menu Bar
menu_bar = Menu(root)
root.config(menu=menu_bar)

# Create File Menu
file_menu = Menu(menu_bar, tearoff=0)
file_menu.add_command(label="Close", command=close_application)
menu_bar.add_cascade(label="File", menu=file_menu)

# Create Help Menu
help_menu = Menu(menu_bar, tearoff=0)
help_menu.add_command(label="About", command=about)
menu_bar.add_cascade(label="Help", menu=help_menu)

# Create a Frame to hold the Notebook with tabs on the left
frame = ttk.Frame(root)
frame.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)

# Create custom tab buttons on the left side
homepage_button = tk.Button(frame, text="Homepage", command=lambda: show_tab(homepage_frame))
character_creator_button = tk.Button(frame, text="Character Creator", command=lambda: show_tab(character_creator_frame))
book_hub_button = tk.Button(frame, text="Book Hub", command=lambda: show_tab(book_hub_frame))
homepage_button.pack(fill=tk.X)
character_creator_button.pack(fill=tk.X)
book_hub_button.pack(fill=tk.X)

# Create frames for the content of each tab
homepage_frame = tk.Frame(root)
character_creator_frame = tk.Frame(root)
book_hub_frame = tk.Frame(root)

# Create a Canvas widget with a scrollbar for each tab
homepage_canvas_frame = tk.Frame(homepage_frame)
homepage_canvas_frame.pack(fill=tk.BOTH, expand=True)

homepage_canvas = tk.Canvas(homepage_canvas_frame, height=200)
homepage_canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)

homepage_scrollbar = ttk.Scrollbar(homepage_canvas_frame, orient="vertical", command=homepage_canvas.yview)
homepage_scrollbar.pack(side=tk.RIGHT, fill="y")

homepage_canvas.configure(yscrollcommand=homepage_scrollbar.set)

# Configure the canvas to scroll
homepage_canvas.bind("<Configure>", lambda event, canvas=homepage_canvas: canvas.configure(scrollregion=canvas.bbox("all")))

# Create a new frame to be the content of the canvas
homepage_canvas_inner_frame = tk.Frame(homepage_canvas)
homepage_canvas.create_window((0, 0), window=homepage_canvas_inner_frame, anchor="nw")

# Add content to the canvas_frame here (Homepage tab)
homepage_content = tk.Label(homepage_canvas_inner_frame, text="Welcome to the Author's Toolbox!")
homepage_content.pack()

# Create a Canvas widget for the Character Creator tab (similar to Homepage tab)
character_creator_canvas = tk.Canvas(character_creator_frame, height=200)
character_creator_canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)

character_creator_scrollbar = ttk.Scrollbar(character_creator_frame, orient="vertical", command=character_creator_canvas.yview)
character_creator_scrollbar.pack(side=tk.RIGHT, fill="y")
character_creator_canvas.configure(yscrollcommand=character_creator_scrollbar.set)
character_creator_canvas_frame = tk.Frame(character_creator_canvas)
character_creator_canvas.create_window((0, 0), window=character_creator_canvas_frame, anchor="nw")

# Create a Canvas widget for the Book Hub tab (similar to Character Creator tab)
book_hub_canvas = tk.Canvas(book_hub_frame, height=200)
book_hub_canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)

book_hub_scrollbar = ttk.Scrollbar(book_hub_frame, orient="vertical", command=book_hub_canvas.yview)
book_hub_scrollbar.pack(side=tk.RIGHT, fill="y")
book_hub_canvas.configure(yscrollcommand=book_hub_scrollbar.set)
book_hub_canvas_frame = tk.Frame(book_hub_canvas)
book_hub_canvas.create_window((0, 0), window=book_hub_canvas_frame, anchor="nw")

# Add content to the canvas_frame here (Book Hub tab)
book_hub_content()

# Configure the canvas to scroll
book_hub_canvas.bind("<Configure>", lambda event, canvas=book_hub_canvas: canvas.configure(scrollregion=canvas.bbox("all")))

# Function to show the selected tab's content
def show_tab(tab_frame):
    # Hide all tab frames
    homepage_frame.pack_forget()
    character_creator_frame.pack_forget()
    book_hub_frame.pack_forget()
    
    # Show the selected tab frame
    tab_frame.pack(fill='both', expand=True)

# Show the homepage frame first
show_tab(homepage_frame)

# Start the main application loop
root.mainloop()
